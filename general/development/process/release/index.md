---
title: Release process
sidebar_label: Release
tags:
  - Processes
  - Release notes
sidebar_position: 7
---

## 8 weeks prior

| # | Major | Minor | Task | Responsibility |
| :---: | :---: | :---: | --- | --- |
| 1. | &#10003; |  | Recurring release epics review:<br/><ul><li>Review how previous deprecation epics are going and share about them.</li><li>Review how previous library review epics are going and share about them.</li></ul> | Integration Team | Integration Team |
| 2. | &#10003; |  | Ensure we are running latest/good behat, phpunit and nodejs (npm) versions. | Integration Team |
| 3. | &#10003; |  | Confirm external testers daily availability from -7w to release (internally with dev manager and then, externally, with contractors). They start in just 1 week! | Integration Team |
| 4. | &#10003; |  | <ul><li>Move QA tests for new features in old release with automated tests from [MDLQA-1](https://tracker.moodle.org/browse/MDLQA-1) to [MDLQA-5249](https://tracker.moodle.org/browse/MDLQA-5249).</li><li> Remind devs:<ul><li>To label issues qa_test_required when a new feature/improvement is landing without automated tests. Also add a comment advising exactly what should be covered in the QA test (for example, steps 6-10 in testing instructions).</li><li>The best possible lang strings land at first attempt. Given the proximity of the major release and to facilitate the work of translators and others... the sooner, the better, instead of relying on (late) en_fixes too much.</li></ul></li></ul> | Testing Maintainer |
| 5. | &#10003; |  | <ul><li>Create a "Must fix for X.Y" version in the Tracker and adjust the ["TR - Set integration priority to one"](https://ci.moodle.org/view/Tracker/job/TR%20-%20Set%20integration%20priority%20to%20one/) and ["TR - Move reopened out from current"](https://ci.moodle.org/view/Tracker/job/TR%20-%20Move%20reopened%20out%20from%20current/) jobs in **all CI servers** to point to it.</li><li>Comment about its creation within HQ so people can apply this to the "Fix Version/s" field in the Tracker.</li><li>Confirm that the following filters based on the [All "must fix" issues](https://tracker.moodle.org/issues/?filter=21363) filter, and are used on the [Release urgent dashboard](https://tracker.moodle.org/secure/Dashboard.jspa?selectPageId=16582), look and work as expected:<ul><li>[release urgent - Peer review list](https://tracker.moodle.org/issues/?filter=18596)</li><li>[release urgent (must fix) - up for grabs](https://tracker.moodle.org/issues/?filter=18594)</li><li>[release urgent- current HQ work](https://tracker.moodle.org/issues/?filter=18861)</li></ul></li><li>Rename the [Release urgent dashboard](https://tracker.moodle.org/secure/Dashboard.jspa?selectPageId=16582) to indicate the version for the upcoming release (QA part of the dashboard will not work yet)</li></ul> | Integration Team |

## 7 weeks prior

| # | Major | Minor | Task | Responsibility |
| :---: | :---: | :---: | --- | --- |
| 1. | &#10003; |  | The [Continuous Integration](../integration/index.md#during-continuous-integration.2ffreeze.2fqa-period) period begins. Warn about it everywhere (telegram, exposed posts...).<br/>Rolling (on demand, beta, rc... all them together with stable weeklies) happens often (Tuesday & Friday are the usual days). All the team is on integration 100% since this week and until the end of continuous. | Integration Team |
| 2. | &#10003; |  | Full demo of new code and sign-off for internal HQ projects. Decide which projects will be completed by the code freeze. | Platform manager / Head of educational solutions |
| 3. | &#10003; |  | <ul><li>Check [closed qa_test_required-labelled issues](https://tracker.moodle.org/issues/?jql=labels%20%3D%20qa_test_required%20AND%20status%20%3D%20Closed) and create new QA tests as required.</li><li>Let the community know [QA testing](../testing/qa.md) starts in two weeks and how they can participate.</li></ul> | Testing Maintainer |
| 4. | &#10003; |  | Warn external developers about the impending code freeze in a post to the [General developer forum](http://moodle.org/mod/forum/view.php?id=55). ([example](https://moodle.org/mod/forum/discuss.php?d=225854)) | Platform Manager |

## 6 weeks prior

| # | Major | Minor | Task | Responsibility |
| :---: | :---: | :---: | --- | --- |
| 1. | &#10003; |  | Confirm the code freeze by replying to the previous warning in the [General developer forum](http://moodle.org/mod/forum/view.php?id=55). | Platform manager |
| 2. | &#10003; |  | This week, once the freeze has happened at 11:00 UTC:<ul><li>The [Manage queues on normal](https://ci.moodle.org/view/Tracker/job/TR%20-%20Manage%20queues%20on%20normal/) job has to be disabled.</li><li>Immediately after that, the [Move awaiting issues to current integration](https://ci.moodle.org/view/Tracker/job/TR%20-%20Move%20awaiting%20issues%20to%20current%20integration/) job must be enabled and executed, only once, and all the candidate issues already @ integration will come to the current queue. All them did the freeze.</li><li>Once run, disable the job again to avoid executing it by mistake.</li><li>Once the previous job has ended, the [Manage queues on continuous](https://ci.moodle.org/view/Tracker/job/TR%20-%20Manage%20queues%20on%20continuous/) job, in charge of managing the integration queues after freeze, will be enabled (until the end of on-sync). It performs some tasks like moving important (must fix, qa, security...) issues to the current integration queue and also keep if fed by priority when there are few issues remaining. **Don't forget** to configure the `releasedate` date to get it automatically holding issues the last week (instead of moving them to current integration) and also processing issues over the on-sync (after release) period.</li></ul> Irrespectively from any automation, issues can, also, be manually picked for integration until the post-release `On Sync` period ends, usually 2 weeks after release.<br/><br/>Review all the new features and improvements so, everything "unrelated" with the release, is given the `integration_held` label. That means that will be ignored unless there is an [unhold request process](../integration/index.md#during-continuous-integration.2ffreeze.2fqa-period) started on them.<br/><br/>Dev leaders promptly vote on held issues labelled with `unhold_requested` label and decide whether they can be allowed to break the freeze. | Integration Team |
| 3. | &#10003; |  | Prepare a fresh installation of the [QA site](http://qa.moodle.net) based on the latest weekly/on-demand release code to make sure the site is not affected by incremental upgrade steps during the development cycle. | QA Master Site Maintainer |
| 4. | &#10003; |  | Create the next "X.Y+1" (next dev) version in the Tracker (MDL and CONTRIB), so people can move delayed stuff to next major release if needed. | Integration Team |

## 5 weeks prior

| # | Major | Minor | Task | Responsibility |
| :---: | :---: | :---: | --- | --- |
| 1. | &#10003; |  | Create new QA test cycle and post in moodle.org front page news forum about [QA testing](../testing/qa.md). | Testing Maintainer |
| 2. | &#10003; |  | Invite community volunteers to start [QA testing](../testing/qa.md). | Community Manager |
| 3. | &#10003; |  | Modify [Current QA cycle filter](https://tracker.moodle.org/issues/?filter=11824) to link to the new QA test cycle | Testing Maintainer |
| 4. | &#10003; |  | Monitor QA fails. Check each fail is real and if so ensure an MDL issue has been created and correctly linked and labelled. | Testing Maintainer |
| 5. | &#10003; |  | Monitor MDL issues created for QA fails. Add them to the "Must fix for X.Y" list and get a developer to work on the issue immediately. | Product delivery lead |
| 6. | &#10003; |  | Begin reviewing [new and changed English language strings](https://lang.moodle.org/mod/forum/view.php?id=7) ready for `en_fix` to be merged 2 weeks prior. | English fixes lang pack maintainer |
| 7. | &#10003; |  | Review standards certifications (Open Badges, LTI, etc) and schedule in recertification to be performed. | Product delivery lead |
| 8. | &#10003; |  | Bump the priority of all the minor new features and improvements being must-fix or already under IR/CLR with X.Y as only affected version. Use [this search to find them](https://tracker.moodle.org/issues/?jql=project%20%3D%20MDL%20AND%20resolution%20%3D%20Unresolved%20%20AND%20type%20!%3D%20%22Bug%22%20AND%20priority%20%3C%20%22Major%22%20%20AND%20(fixversion%20in%20(versionMatches(%22Must%20fix%20for%20.*%22))%20OR%20(%22Component%20Lead%20Review%22%20IS%20NOT%20EMPTY%20AND%20affectedversion%20%3D%204.1))) (note that it will need to be adjusted for current X.Y version). Standard message will be used to explain the priority raise. | Integration Team |

## 4 weeks prior

| # | Major | Minor | Task | Responsibility |
| :---: | :---: | :---: | --- | --- |
| 1. | &#10003; |  | Start reviewing fixed issues and add the release_notes label to all issues to be listed in the release notes. | Product manager / Head of educational solutions |
| 2. | &#10003; |  | Organise a meeting to review requirements for adding user tours for new features in the upcoming release (clone of [MDL-72783](https://tracker.moodle.org/browse/MDL-72783)). Review existing tours and remove very old ones (clone of [MDL-72781](https://tracker.moodle.org/browse/MDL-72781)) | Product delivery lead |
| 3. | &#10003; |  | Beta release (The Moodle release tool - `mdlrelease` - manages it): Release normal weeklies but with these changes in the master branch being considered all the time, until we are feature complete (can happen @ -4w - ideally - but also later): <ul><li>`version.php`: Move to `$maturity = MATURITY_BETA` and `$release = 'X.Ybeta (Build:xxxxxxxx)'`</li><li>tag git repo with: `vX.Y.0-beta` (and `MOODLE_XY_BETA` as description and Git tag)</li><li>Automatic: Confirm packages are available under [download.moodle.org](https://download.moodle.org) (and windows).</li><li>Once the beta is available create the `testing matrix for X.Y.0` and share it @ HQ & Dev. chat.</li><li>(Optionally) Announce Beta release in forums (ideally once packages are available).</li></ul> | Integration Team |
| 4. | &#10003; |  | Clone [MDL-72815](https://tracker.moodle.org/browse/MDL-72815) for the X.Y release, adding there all the debugging / PHP notices happening in the web server logs while running tests. | Integration Team |
| 5. | &#10003; |  | Release candidates release (The Moodle release tool - `mdlrelease` - manages it): At some points (between beta to final release) produce release candidates (Z = 1, 2, 3..), which are normal builds with the following changes:<ul><li>`version.php`: Move to `$maturity = MATURITY_RC` and `$release = 'X.YrcZ (Build:xxxxxxxx)'`</li><li>tag git repo with: `vX.Y.0-rcZ` (and `MOODLE_XY_RCZ` as description and Git tag)</li><li>Automatic: Confirm packages are available under [download.moodle.org](https://download.moodle.org) (and windows).</li><li>Upgrade all the Moodle CI sites to recent release candidate by configuring the "Moodle CI Auto Upgrade" job in all them.</li></ul> | Integration Team |
| 6. | &#10003; |  | Add a new version in the Plugins Directory with the version's name and the beta release version build number (https://moodle.org/plugins/admin/softwareversions.php).<ul><li>Any standard plugins being retired from the release can transition to Add-on (that supports this release and/or any previous ones) now.</li><li>These plugins currently collect at https://moodle.org/plugins/browse.php?list=contributor&id=1532512</li></ul> | Plugins Liaison |
| 7. | &#10003; |  | Push any plugins to the plugins database which were previously a part of core. | Plugins Liaison |
| 8. | &#10003; |  | Tidy up current latest en version of Moodle Docs prior to copying it to create new version wiki as described in [New docs version process](./newuserdocs.md). | Community Manager |
| 9. | &#10003; |  | Review the [list of features and improvements submitted before code freeze](https://tracker.moodle.org/issues/?filter=17705&jql=filter%20%3D%2011701%20AND%20type%20!%3D%20Bug) which are awaiting integration review and decide on related QA tests to be put on hold. This should be done in the same meeting in point 2. | Product delivery lead |

## 3 weeks prior

| # | Major | Minor | Task | Responsibility |
| :---: | :---: | :---: | --- | --- |
| 1. | &#10003; |  | Ask developers to begin QA tests marked [`external_skipped`](https://tracker.moodle.org/issues/?filter=22055) then [`test_server_required` tests](https://tracker.moodle.org/issues/?filter=22055&jql=filter%20%3D%20%22Current%20QA%20cycle%20filter%22%20AND%20status%20%3D%20Open%20AND%20labels%20%3D%20test_server_required%20) and [`credentials_required` tests](https://tracker.moodle.org/issues/?filter=22055&jql=filter%20%3D%20%22Current%20QA%20cycle%20filter%22%20AND%20status%20%3D%20Open%20AND%20labels%20%3D%20credentials_required). | Product delivery lead |
| 2. | &#10003; |  | Create new en and de Moodle Docs version wikis. | Moodle Docs Maintainer |
| 3. | &#10003; |  | Go through all points listed under 3 weeks prior in [New docs version process](./newuserdocs.md). | Community Manager |
| 4. | &#10003; |  | Review issues with labelled with [`dev_docs_required`](https://tracker.moodle.org/issues/?filter=11824&jql=labels%20in%20%28dev_docs_required%29%20AND%20resolution%20%3D%20fixed%20ORDER%20BY%20assignee%20ASC%2C%20created%20ASC), prompting assigned developers to create/update this documentation and remove this label when relevant docs are updated. | Product delivery lead |
| 5. | &#10003; | &#10003; | Organise a meeting to verify how everything is going and, before the end of the week, decide (dev leaders & integrators) if there are real reasons for delaying any release. Whenever a delay is agreed, run the *"Release delaying process"* (doc) actions ASAP.<br/><br/>**Important note**: ASAP stands for as soon as possible ;-), the delay needs to happen before the last week before release begins (there are flows changing that week requiring the decision and actions to be taken and applied earlier) | Product delivery lead |

## 2 weeks prior

| # | Major | Minor | Task | Responsibility |
| :---: | :---: | :---: | --- | --- |
| 1. | &#10003; |  | Check the number of open QA tests. Depending on the amount of work involved, encourage HQ developers to assist from the start of the week or later in the week in order to achieve the target of 100% pass rate by the end of the week. | Product delivery lead |
| 2. | &#10003; |  | Create MDLSITE issue to ensure all [prototype.moodle.net](https://prototype.moodle.net) sites which are no longer relevant (part of release) are removed from [prototype.moodle.net](https://prototype.moodle.net) | Platform manager / Head of educational solutions |
| 3. | &#10003; | &#10003; | Merge [fixes from `en_fix`](https://tracker.moodle.org/issues/?jql=summary%20~%20%22en_fix%22%20order%20by%20createdDate%20desc) pack and then integrate them. | AMOS Maintainer |
| 4. | &#10003; |  | Give Partners complete branded Marketing pack for release including list and description of major new features. | Marketing Manager |
| 5. | &#10003; |  | Label (`ui_change`) in the Tracker all pending issues having **noticeable UI modifications** and track them in the "[Late landing UI changes](https://docs.google.com/spreadsheets/d/18xZf9OgKrndi7CwSTwjwjF_rzGYCWFuGjNNaaDVZDM4/edit?usp=sharing)" sheet, in order to have all the associated docs, screenshots, videos under control. The Integration and Documentation people will try to **keep the sheet updated until release**. | Integration Team |
| 6. | &#10003; | &#10003; | For major releases, use (clone if needed) [MDL-72836](https://tracker.moodle.org/browse/MDL-72836) to keep the security.txt files in all supported branches updated. For minor releases, also check the security.txt expiry dates in all security supported branches in case known release delays will result in any security.txt expiring before the next release - in that case relevant branches should also be updated. | Security Officer |
| 7. | &#10003; | &#10003; | Identify issues that may block the release (for example, security, must-fix issues, etc.) and confirm with team leads. This is to ensure that these issues are prioritised and allow us to be able to land them as early as possible and ensure a timely release schedule. | Integration Lead |

## 1 week prior

| # | Major | Minor | Task | Responsibility |
| :---: | :---: | :---: | --- | --- |
| 1. | &#10003; |  | Clone as many filters as needed in the Tracker, modifying them to point to the new, upcoming, branch (keeping same perms, title...). | Integration Team |
| 2. | &#10003; | &#10003; | Create new minor version X.Y.Z+1 in the Tracker (MDL and CONTRIB). Archive any version > 6 months old, verifying that [there aren't open issues using that version](https://tracker.moodle.org/issues/?jql=project%3DMDL%20AND%20status%20!%3D%20Closed%20AND%20fixVersion%20%3D%20VERSION_TO_ARCHIVE). | Integration Team |
| 3. | &#10003; |  | Clone [MDL-77940](https://tracker.moodle.org/browse/MDL-77940) and bump all versions, requires and dependencies along all plugins in codebase to planned release dates. | Integration Team |
| 4. | &#10003; | &#10003; | Post a "Heads-up" message on the [General Developer forum](http://moodle.org/mod/forum/view.php?id=55) and [MUA website](https://moodleassociation.org/). | Platform Manager |
| 5. | &#10003; | &#10003; | Post a "Heads-up" message on the [Partners forum](https://partners.moodle.com/mod/forum/view.php?id=147). | Security Officer |
| 6. | &#10003; | &#10003; | Post a "Heads-up" message on Twitter and other outlets. | Marketing Officer |
| 7. | &#10003; | &#10003; | Identify security issues that need to be integrated using the [security issues under integration filter](https://tracker.moodle.org/issues/?filter=21712) (includes held, being integrated and ready issues).<ul><li>Integrate from provided patches into supported branches (including branches supported only for security issues).</li><li>Ensure security issues are given priority in weekly integration and testing. Note that the `--weekly` releases to be performed this week are 100% normal and cover the standard (supported) branches. security branches will come as part of the release process later in the week.</li></ul> | Integration Team |
| 8. | &#10003; | &#10003; | Collect security issues into a clone of the [last advisory in the list](https://tracker.moodle.org/issues/?jql=project%20%3D%20MDL%20AND%20level%20is%20not%20EMPTY%20AND%20summary%20~%20%22security%20advisories%22%20ORDER%20BY%20updated%20DESC) to prepare for release of Security Advisories.<ul><li>Determine which security issues will be integrated.</li><li>Request CVE Identifiers by emailing issue descriptions to secalert@redhat.com with a message like: <q>The following security issues have been discovered in Moodle. We request CVE Identifiers for these issues. We will be releasing the security announcements for these on moodle.org on XXX at 12noon AWST which is 04:00 UTC</q>The email subject should include the characters `[vs]`. The format needs to be plain text or encrypted. When granted CVE Identifiers, our issues should appear in the [CVE list](http://cve.mitre.org/cve/cve.html). [More instructions](http://oss-security.openwall.org/wiki/mailing-lists/distros) are available (since 2015 we request identifiers from redhat and not from distros).</li><li>Post security issues as a reply to the "Heads-up" message on the [Partners forum](https://partners.moodle.com/mod/forum/view.php?id=147).</li></ul> | Security Officer |
| 9. | &#10003; | &#10003; | Release notes tasks:<ul><li>Review and complete the [release notes](../../../releases.md), making sure that issues have easily understandable summaries. Aim to have the release notes mostly complete on the Wednesday before release, and fully complete on the Friday, to give translators time to translate them.</li><li>Ensure all issues labelled with `ui_change`, `api_change` and `release_notes` are listed as UI changes, functional changed and fixes/improvements respectively in the release notes.</li></ul> | Platform Manager / Head of educational solutions |
| 10. | &#10003; |  | Last week managing / holding issues:<ul><li>[The "candidates queue"](https://tracker.moodle.org/issues/?filter=14000) is handled automatically by the [continuous queue manager](https://ci.moodle.org/view/Tracker/job/TR%20-%20Manage%20queues%20on%20continuous/) (given it has correctly configured the release day). And it will automatically hold any issue arriving and not being "important".</li><li>[The "current queue"](https://tracker.moodle.org/issues/?jql=project%20%3D%20MDL%20AND%20(%22Currently%20in%20integration%22%20is%20not%20EMPTY%20OR%20status%20in%20(%22Integration%20review%20in%20progress%22%2C%20%22Waiting%20for%20feedback%22%2C%20%22Waiting%20for%20testing%22%2C%20%22Testing%20in%20progress%22%2C%20%22Problem%20during%20testing%22%2C%20Tested%2C%20%22Waiting%20for%20security%20testing%22%2C%20%22Security%20testing%20in%20progress%22%2C%20%22Security%20test%20failed%22%2C%20%22Waiting%20for%20release%22%2C%20%22Waiting%20for%20push%22))%20ORDER%20BY%20%22Integration%20priority%22%20DESC%2C%20%22Component%20Lead%20Review%22%20ASC%2C%20priority%20DESC%2C%20votes%20DESC%2C%20updatedDate%20ASC) has to be handled manually by the iTeam, so any issue there, awaiting, needs to be held, with the standard last week message and moved out from integration given:<ul><li>It's not "important".</li><li>It has not been unhold previously.</li></ul></li><li>If there is any issue already in progress, or there are doubts about any issue, always comment with the team. Depending on the remaining work and/or other criteria they may be acceptable and processed.</li><li>Ensure the next point effectively happens and the 2 lists are reviewed.</li></ul>| Integration Team |
| 11. | &#10003; |  | Organise a meeting to review the following issues: <ul><li>Check on the [`Must fix for X.Y version`](https://tracker.moodle.org/issues/?filter=21363). Filter out unrealistic issues.</li><li>Check on the ["Bug issues held last week before release"](https://tracker.moodle.org/issues/?filter=22350). Consider to request the un-holding of release related/blocker ones.</li></ul> | Product delivery lead |
| 12. | &#10003; |  | Upgrade [moodle.org](https://moodle.org/) to beta release |  |
| 13. | &#10003; |  | Prepare pull requests for CI Repositories:<ul><li>`MR1`: Create a new version, with unit tests, in Jobs repository ([see example from 4.2 release](https://git.in.moodle.com/integration/nightlyjobs/merge_requests/45))</li><li>`MR2`: Create a new symlink for the version in [moodle-ci-runner](https://github.com/moodlehq/moodle-ci-runner) repository ([see example from 4.2 release](https://github.com/moodlehq/moodle-ci-runner/pull/101))</li><li>`MR3`: Configure CIs to skip language upgrade in [moodle-ci-runner](https://github.com/moodlehq/moodle-ci-runner) repository ([see example from 4.2 release](https://github.com/moodlehq/moodle-ci-runner/pull/102))</li><li>`MR4`: Configure CIs to stop skipping language upgrade in [moodle-ci-runner](https://github.com/moodlehq/moodle-ci-runner) repository for after on-sync ([see example from 4.2 release](https://github.com/moodlehq/moodle-ci-runner/pull/103)) -- **Note**: This change should be based on the previous and only applied when the lang packs corresponding to the version being released are available.</li></ul> | Integration Team |
| 14. | &#10003; |  | Go through all points listed under 1 week prior in [New docs version process](./newuserdocs.md). | Community Manager |
| 15. | &#10003; |  | Update the `BRANCHLIST` and `VERSIONLIST` in the [JSDoc](https://github.com/moodle/jsdoc) and [PHPDoc](https://github.com/moodle/phpdoc) repositories with the list of supported versions. These are built on a Sunday so this should be done in the final week before release. | Integration Team |

## Releasing

### Packaging

:::info

This should happen immediately before the next integration cycle begins on Monday (that is, some days after last weekly, 2 days prior to official release).

:::

| # | Major | Minor | Task | Responsibility |
| :---: | :---: | :---: | --- | --- |
| 1. | &#10003; | &#10003; | Check list:<ul><li>Make sure there are no real blockers introduced in the last weekly (install, upgrade...).</li><li>Confirm that the latest [`en_fix` changes](https://tracker.moodle.org/issues/?jql=summary%20~%20%22en_fix%22%20order%20by%20createdDate%20desc) have been generated and integrated.</li><li>Verify that [all security issues](https://tracker.moodle.org/issues/?jql=text%20~%20%22%2BPrepare%20%2Bsecurity%20%2Badvisories%20%2Bfriends%22%20ORDER%20BY%20updated%20DESC) have been integrated and there are not leftovers in the security area (but for delayed majors, where some security issues may have been introduced along the delay and they will be postponed to next minors).</li></ul> | Integration Team |
| 2. | &#10003; | &#10003; | Verify all unit tests and integration tests have passed (check all current CI servers in use). | Integration Team |
| 3. | &#10003; |  | Verify QA tests have passed. | Integration Team |
| 4. | &#10003; | &#10003; | Timing prerequisites (don't continue with the process if not within the time window!):<ol><li>Latest weeklies before the minor/major releases must be done (`moodle-package-extract-and-postprocess` email should confirm this has happened around 09:00 Australia/Perth).</li><li>Minor and major releases can be packaged at any time within the 96 hours before the automatic releasing time (Monday 09:00 Australia/Perth). And always, at very least, 4 hours before then (to allow the server to prepare all the stuff).</li></ol> In practice, this means that the packaging of minor/major releases must be done, assuming that weeklies were rolled normally on Thursday, between Friday 09:00 and Monday 05:00 (Australia/Perth times). **Breaking any of these rules will require manual operation in the server**, forcing repackaging and releasing.<br/><br/>Follow the `mdlrelease` steps:<ul><li>Run the `prerelease.sh` script to generate the target minor (`--type minor`) and major (`--type major`) releases and their corresponding tags. Pay attention to the complete output of the process: permissions, svg... changes (only for majors)... Triple verify all changes are correct! (can use the `--show` option to inspect them). </li><li>Follow the on-screen instructions.</li><li>Push changes to integration.git (but tags).</li></ul><br/>For major releases, only when a new STABLE branch has been created:<ul><li>Run the `prerelease.sh` script (`--type back-to-dev`) to move master to next X.Y+1 development version/branch.</li><li>Push changes to integration.git - note this will lead to the "versions checker" failing for master, no problem, it will be fixed by the 1st cloned issue at #12 below).</li><li>Configure `mdlrelease` (`config.sh`) to know about the new `MOODLE_XY` stable branch.</li><li>Update the old CI server(s) by cloning all the "master" jobs to a new `MXY` view (trick: do it down-top, way easier). Don't forget to re-chain the jobs properly.<ul><li>Adjust `master` compare DB jobs to check for upgrade from `MOODLE_XY_STABLE`.</li><li>Configure the "05. Check version.php files" jobs both for the involved branches (XY and master) to define the interval of versions allowed in each.</li><li>Run all them.</li></ul></li><li>Update the new CI infrastructure:<ul><li>`MR1`: Merge pull request for new version in [CI Jobs Repository](https://git.in.moodle.com/integration/nightlyjobs)</li><li>`MR2`: Merge pull request for symlink in [moodle-ci-runner](https://github.com/moodlehq/moodle-ci-runner) repository.</li><li>`MR3`: Merge pull request for skipping the language upgrade in [moodle-ci-runner](https://github.com/moodlehq/moodle-ci-runner) repository.</li><li>Clone all the "B - master" jobs to a new "B - XY" view (there is a [maintenance job](https://ci.moodle.org/view/maintenance/job/MAINT%20-%20Clone%20jobs%20from%20view/) to perform the operation).</li></ul></li></ul> <br/>Both with minors and majors, continue with the `mdlrelease` steps:<ul><li>Once CI servers have ended and all jobs have passed, **push tags** and run the `release.sh` script to apply the changes to moodle.git.</li><li>If needed configure `mdlrelease` (`config.sh`) to get rid of any unsupported version and adjust stable and security branches. Make a pull request with the changes.</li><li>Don't forget the ["After the release"](https://github.com/moodlehq/mdlrelease/#after-the-release) tasks.</li></ul> | Integration Team |
| 5. | &#10003; | &#10003; | Post a "git repos updated & tagged" message on the [Partner forum](https://partners.moodle.com/mod/forum/view.php?id=810) | Integration Team |
| 6. | &#10003; |  | In the [performance comparison repository](https://github.com/moodlehq/moodle-performance-comparison), set the new release commit hash as `$basecommit` in the master branch and create a new `MOODLE_XY_STABLE` branch from it. ([example](https://github.com/moodlehq/moodle-performance-comparison/commit/7c875f03e52641f69674235a8947131d77691299)). Also, apply it to the current performance testing infrastructure. | Integration Team |
| 7. | &#10003; | &#10003; | Wait for the automated (every 2 hours) moodle-package to finish building for all versions. Verify the process has ended successfully (email). | Integration Team |
| 8. | &#10003; |  | <ul><li>Create new windows packager script (cloning the current master one and configuring it).</li><li>Edit the stats.php script (in the `moodle-local_downloadmoodleorg` repository), adding the new branch to the versions. Push it. Next time the plugin is deployed (normally 1 week after release approx) the stats will start showing the new branch statistics.</li></ul> | Integration Team |
| 9. | &#10003; | &#10003; | In the Tracker: <ul><li>Visit the versions page and make the release, bumping all remaining open bugs to the next point release. If there is not next (end of support), clean that version from all the issues having it as "Fix for". This must be done both for the [Moodle Project](http://tracker.moodle.org/secure/project/ViewProject.jspa?pid=10011) and the [Plugins project](http://tracker.moodle.org/secure/project/ViewProject.jspa?pid=10033).</li><li>Archive all versions but the ones being released, verifying that [there aren't open issues using that version](https://tracker.moodle.org/issues/?jql=project%3DMDL%20AND%20status%20!%3D%20Closed%20AND%20fixVersion%20%3D%20VERSION_TO_ARCHIVE).</li><li>Remove from all screens the custom fields belonging to 100% unsupported branches.</li></ul><br/>For major releases only:<ul><li>Release and archive the [`Must fix for X.Y` versions](https://tracker.moodle.org/issues/?jql=affectedVersion%20~%20%22must%20fix%20for*%22%20OR%20fixVersion%20~%20%22must%20fix%20for*%22), it must be empty to do so.</li></ul> | Integration Team |
| 10. | &#10003; |  |<ul><li>Create the new `Pull X.Y Branch` and `Pull X.Y Diff URL` custom fields and spread them to all the screens needing them (copy from previous ones). Order them properly on each screen. Re-index Tracker.</li><li>In the CI server edit the following jobs to make them meet the new `Pull X.Y Branch` field:<ul><li>[`Bulk pre-check issues`](http://integration.moodle.org/view/tracker/job/Tracker%20-%20CI%20-%20Bulk%20precheck%20issues/)</li><li>[`Pre-launch DEV jobs (awaiting_integration)`](https://ci.moodle.org/view/Tracker/job/TR%20-%20Bulk%20pre-launch%20DEV%20jobs%20(awaiting_integration)/)</li><li>[`Pre-launch DEV jobs (awaiting_clr)`](https://ci.moodle.org/view/Tracker/job/TR%20-%20Bulk%20pre-launch%20DEV%20jobs%20(awaiting_clr)/)</li><li>[`Pre-launch DEV jobs (list_of_mdls)`](https://ci.moodle.org/view/Tracker/job/TR%20-%20Bulk%20pre-launch%20DEV%20jobs%20(list_of_mdls)/)</li><li>[`Pre-launch SDEV jobs (list_of_mdls)`](https://ci.moodle.org/view/Tracker/job/STR%20-%20Bulk%20pre-launch%20SDEV%20jobs%20(list_of_mdls)/)</li></ul><br/>At the same time, remove from those jobs any branch belonging to 100% unsupported branches.</li><li>Edit the [`Tracker - CI - Check marked as integrated`](https://ci.moodle.org/view/Tracker/job/TR%20-%20Check%20marked%20as%20integrated/) job to configure the development branches (`devbranches`) (39, 310, 311, 400...) actually active. Normally only the branch corresponding to master, but also accepts a comma separated list when under parallel development ("310,400" or "311,400" for example). Ordered by planned release date.</li><li>Check/configure (again, this may be has been already executed few steps above) the `05. Check version.php files` jobs both for the involved branches (`XY` and `master`) to define the interval of versions allowed in each.</li></ul> | Integration Team |
| 11. | &#10003; | &#10003; | In the Tracker: <br/>For major releases only:<ul><li>Create the new "X.Y regressions" version to be applied to every issue found to be a recent problem introduced by the major release. These issues should get priority after release.</li><li>Adjust the [Latest regressions](https://tracker.moodle.org/issues/?filter=17528) filter (requires login).</li></ul><br/>For all releases:<ul><li>Verify how the [`X.Y regressions` versions are going](https://tracker.moodle.org/issues/?jql=project%20%3D%20MDL%20AND%20resolution%20%3D%20Unresolved%20AND%20affectedVersion%20in%20(versionMatches(%22.*regressions%22))) (requires login) and ping Development Managers about. Package and archive them once empty.</li></ul> | Integration Team |
| 12. | &#10003; |  | Clone [MDL-74509](https://tracker.moodle.org/browse/MDL-74509) and [MDL-74510](https://tracker.moodle.org/browse/MDL-74510), to be resolved ASAP. | Integration Team |
| 13. | &#10003; |  | <ul><li>Create the new `MOODLE_XY_STABLE` and `lastbased-MOODLE_XY_STABLE` branches in the security repo (branching from the just created upstream `MOODLE_XY_STABLE` branch).</li><li>Cherry pick any security commit present in the security repository's master branch to the new `MOODLE_XY_STABLE` branch (note that normally there should not be any, see point #1 check list above).</li><li>Verify the new security jobs exist for the new branch and check it's working in all servers, keeping only enabled the public one.</li></ul> | Integration Team |
| 14. | &#10003; |  | Protect the MOODLE_XY_STABLE branches in github interface to prevent non-FF accidents ( [MDLSITE-4183](https://tracker.moodle.org/browse/MDLSITE-4183) ) | Integration Team |

### Release day

:::info

Usually on Monday

:::

| # | Major | Minor | Task | Responsibility |
| :---: | :---: | :---: | --- | --- |
| 1. | &#10003; | &#10003; | The execution of `moodle-package-extract-and-postprocess X` script may be needed if the releases **are not going to be published on Monday** but another weekday (X is the weekday, (1-7) starting in Monday).<br/>By default it happens automatically around 09:00 AM Perth/Australia time (check emails then). | Integration Team |
| 2. | &#10003; | &#10003; | Verify release status, download pages and windows packages. | Integration Team |
| 3. | &#10003; | &#10003; | If needed, modify the downloads cfg script (`serverscripts`) to decide about branches status, master visibility and windows availability. Push changes, will be auto-deployed in a few minutes. | Integration Team |
| 4. | &#10003; | &#10003; | Add/update the release date, build number and link on the [Releases page](../../../releases.md) and date in new version pages. | Integration Team |
| 5. | &#10003; | &#10003; | Notify all registered sys admins, including security notes with CVE identifiers, using the [mailing list server](http://lists.moodle.org/). | Security Officer |
| 6. | &#10003; |  | Post about the Major release on the [moodle.org News forum](http://moodle.org/news/) | Head of educational solutions |
| 7. |  | &#10003; | Post about minor releases on the [moodle.org News forum](http://moodle.org/news/) | Platform Manager |
| 8. | &#10003; |  | Perform the steps described at [HOWTO-MAJOR-RELEASE.txt](https://github.com/moodlehq/moodle-local_amos/blob/main/HOWTO-MAJOR-RELEASE.txt) guidelines.  | AMOS Maintainer |
| 9. | &#10003; | &#10003; | Verify, 24h after tagging, that https://moodle.org/dev/contributions.php has been updated with new versions. If not, file an urgent `MDLSITE` issue, crons must be running! | Integration Team |
| 10. | &#10003; |  | For `en` and `de` Moodle Docs, update default redirects and enable email notifications. | Moodle Docs Maintainer |
| 11. | &#10003; |  | Go through all points listed under Day of release in [New docs version process](./newuserdocs.md). | Community Manager |
| 12. | &#10003; |  | <ul><li>Decide the `Full demo`, `Code freeze` and `QA begins` dates for the next `X.(Y+1)` major release and put them in the [Moodle development calendar](https://www.google.com/calendar/ical/moodle.com_p4c2oe7hsb77ltaro5qtihb5d4%40group.calendar.google.com/public/basic.ics). They will be -7w, -6w and -5w before release date respectively.</li><li>Update the `Full demo`, `Code freeze`, `QA begins` and `Release` dates on the Roadmap page.</li><li>Notify the Community Manager of new dates to be added to the moodle.org calendar.</li></ul> | Product delivery lead |
| 13. | &#10003; | | Add calendar events in the [moodle.org calendar](https://moodle.org/calendar) for coming Major and Minor releases up to the next Major release. | Community Manager |
| 14. | &#10003; | &#10003; | Update release schedule image on [Releases page](../../../releases.md#version-support) | Platform Manager |
| 15. | &#10003; |  | Important: This must be done **once it's already release day @ UTC** (aka, after Australia/Perth 08:00) or the **queues manage with hold them again** because it's still "last week before release".<br/>The `integration_held` label will be removed only from [**bug issues** awaiting integration](https://tracker.moodle.org/issues/?jql=filter%3D13669%20AND%20type%20in%20(bug%2C%20task%2C%20Sub-task)) and [**bug issues** awaiting component leads review](https://tracker.moodle.org/issues/?jql=filter%3D%2023331%20AND%20type%20in%20(bug%2C%20task%2C%20Sub-task)); they correspond to last-week bugs that were held because of them being unrelated with the release. Now they can be processed, under on-sync rules. Standard message will be used to explain the un-hold. | Integration Team |

## 1 week after

| # | Major | Minor | Task | Responsibility |
| :---: | :---: | :---: | --- | --- |
| 1. | &#10003; | &#10003; | Publish the X.Y+ packages for download.moodle.org (should be automatic once weeklies are packaged).<br/>For major releases, within the on-sync period, master packages will be generated using the prerelease.sh script (`--type on-sync`). That guarantees `XY_STABLE` and `master` versions are kept the same. The last week, when leaving the on-sync period, master package will be generated normally (implicit `--type weekly`), so versions will diverge and dev can continue separately from that point. | Integration Team |
| 2. | &#10003; | &#10003; | Update the version.php in git to be `X.Y.Z+` during the next weekly integration process | Integration Team |
| 3. |&#10003; | &#10003; | Create a new release notes page for the next minor versions (using the [release notes template](https://docs.moodle.org/dev/Release_notes_template).) Add note to top of relevant version page about security support. | Platform Manager |
| 4. | &#10003; | &#10003; | Add all security advisories to [Security news](http://moodle.org/security) and [release notes](https://docs.moodle.org/dev/:Category:Release_notes) with links to security advisories | |Security Officer |
| 5. | &#10003; | &#10003; | Notify about publications of CVE using form: https://cveform.mitre.org/ | Security Officer |
| 6. | &#10003; |  | Upgrade moodle.org and all other Moodle community sites (next sites first, then production) |  |
| 7. | &#10003; |  | **Deprecations:**<ul><li>Create the next deprecation epic (for `X.Y+1+2y`) similar to [MDL-74579](https://tracker.moodle.org/browse/MDL-74579) and add standard issues to it:<ul><li>Final deprecation of `lib/deprecatedlib.php` (like [MDL-74580](https://tracker.moodle.org/browse/MDL-74580))</li><li>Removal of deprecated Behat steps (like [MDL-74581](https://tracker.moodle.org/browse/MDL-74581))</li><li>Removal of strings (like [MDL-74582](https://tracker.moodle.org/browse/MDL-74582)) and</li><li>Removal of renamed classes ([MDL-74583](https://tracker.moodle.org/browse/MDL-74583)).</li></ul></li></ul>The issue can be based/cloned on the previous one and linked ("has to be done after") with it.<ul><li>Review [how previous deprecation epics are going](https://tracker.moodle.org/issues/?jql=project%20%3D%20MDL%20AND%20text%20~%20%22Collect%20together%20deprecated%20and%20planned%20code%20changes%20for%20Moodle%22%20AND%20affectedVersion%20in%20(releasedVersions()%2C%20%22Future%20Dev%22)%20AND%20resolution%20%3D%20Unresolved%20ORDER%20BY%20issuekey%20%20DESC) and share about them.</li></ul><br/>**Libraries:**<ul><li>Create the next third party libraries epic for `X.Y+1`, similar to [MDL-73715](https://tracker.moodle.org/browse/MDL-73715). The issue should refer to the list of [Moodle libraries credits](../../../community/credits/thirdpartylibs.md). The issue can be based/cloned on the previous one and linked ("has to be done after") with it. **Drag/link opened issues from the previous one**, avoiding leaving unfinished stuff.</li><li>Review [how previous library review epics are going](https://tracker.moodle.org/issues/?jql=project%20%3D%20MDL%20AND%20(summary%20~%20%22Review%20third%20party%20libraries%20for%20new%20versions%22%20OR%20summary%20~%20%22Review%20third-party%20libraries%20for%20upgrade%22)%20AND%20affectedVersion%20in%20(releasedVersions()%2C%20%22Future%20Dev%22)%20AND%20resolution%20%3D%20Unresolved%20ORDER%20BY%20issuekey%20%20DESC) and share about them.</li></ul> | Integration Team |

## 2 weeks after

| # | Major | Minor | Task | Responsibility |
| :---: | :---: | :---: | --- | --- |
| 1. | &#10003; |  | Once the "On Sync" period ends:<ul><li>Confirm that versions (`XY_STABLE` and `master`) diverged properly the last on-sync week. If not, proceed to it by manually bumping master the version to the current date @ integration.git.</li><li>Disable the ["Manage queues on continuous"](https://ci.moodle.org/view/Tracker/job/TR%20-%20Manage%20queues%20on%20continuous/) job. It has served us well.</li><li>The `integration_held` label will be removed from all [issues awaiting integration](https://tracker.moodle.org/issues/?filter=13669) and [issues awaiting component leads review](https://tracker.moodle.org/issues/?filter=23331), so they will, automatically (see next point), be moved to the various integration queues. Send an `unholding + rebase` message to all those issues.</li><li>Enable the ["Manage queues on normal"](https://ci.moodle.org/view/Tracker/job/TR%20-%20Manage%20queues%20on%20normal/) job. It will control the queues over the coming months, until the next freeze.</li><li>In the [Jenkins CI server](https://ci.moodle.org/) enable all the jobs corresponding to the new branch (`B-XYZ` view) that were created on packaging day.</li></ul> | Integration Team |
| 2. | &#10003; |  | The discussion about environmental requirements for next X.Y+1 major release ([MDL-71747](https://tracker.moodle.org/browse/MDL-71747)) will end and the issue will be resolved **immediately**. A new issue, about the requirements for the next `X.Y+2` major release will be created at the same time by cloning the previous one and dragging any non-resolved detail (due date = 3w after release). | Integration Team |
| 3. | &#10003; |  | Ensure [Language pack for master (X.Y+1)](https://download.moodle.org/langpack/X.Y+1/) is available and merge the pull request MR4 for stop skipping the language upgrade in [moodle-ci-runner](https://github.com/moodlehq/moodle-ci-runner) repository. | Integration Team |
| 4. | &#10003; |  | Ensure release retrospectives are held for each of the LMS teams and results are actioned. | Platform Manager / Head of educational solutions |
| 5. | &#10003; |  | <p>Prepare for the next version of PHP.</p> <p>We need to ensure that the Moodle versions that will support the next version of PHP are compatible with it.</p> <ul><li>If an epic has not been created yet, create an epic issue for it (see [MDL-76405](https://tracker.moodle.org/browse/MDL-76405) as an example)</li> <li>Go through the list of changes for the upcoming PHP version, identify potential breaking changes in Moodle and add them to the epic.</li></ul> <p>Related links:</p> <ul><li>[PHP versions](https://www.php.net/supported-versions.php)</li> <li>[PHP.Watch](https://php.watch/versions)</li> </ul> | Integration team |

## 1 month after

| # | Major | Minor | Task | Responsibility |
| :---: | :---: | :---: | --- | --- |
| 1. | &#10003; |  | Remove, in CI servers, all the jobs and views corresponding to branches which support has ended completely. (there is a [maintenance job](https://ci.moodle.org/view/maintenance/job/MAINT%20-%20Remove%20all%20jobs%20from%20view/) to perform the operation). | Integration Team |
| 2. | &#10003; |  | Upgrade all the Moodle CI sites to recent major release by configuring the "Moodle CI Auto Upgrade" job in all them. | Integration Team |
| 3. | &#10003; |  | Confirm that there isn't any remaining [`integration_held`](https://tracker.moodle.org/issues/?jql=filter%3D13669%20OR%20filter%3D23331) issue from latest release, proceeding to un-hold them immediately. Note that there may exist [other "held" issues](https://tracker.moodle.org/issues/?filter=13669&jql=project%20%3D%20MDL%20AND%20labels%20in%20(integration_held)%20ORDER%20BY%20%22Integration%20priority%22%20DESC%2C%20priority%20DESC%2C%20votes%20DESC%2C%20%22Last%20comment%20date%22%20ASC), unrelated with latest release. This process step does not affect them. | Integration Team |

## See also

- [Deprecation process](../../policies/deprecation.md)
